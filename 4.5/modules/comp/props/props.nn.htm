<props-editor inline-template>

    <div>
        <table class="table is-fullwidth">
            <tr>
                <th width="5%" class="has-text-centered"><button type="button" class="button is-small is-white" @click="select_inverse()"><i class="fa fa-check-square-o"></i></button></th>
                <th width="30%">Код</th>
                <th width="10%">Тип</th>
                <th width="50%">Значение</th>
                <th width="5%">&nbsp;</th>
            </tr>
            <tr v-for="row in lst">
                <td class="has-text-centered"><input type="checkbox" v-model="row.checked"/>
                </td>
                <td><a href="javascript:;" @click="edit_prop(row)">{{"row.code"|js}}</a></td>
                <td>{{"type_name(row.type)"|js}}</td>
                <td>{{"row.value"|js}}</td>
                <td class="has-text-right"><button type="button" class="button is-primary is-small" @click="edit_prop(row)"><i class="fa fa-pencil"></i></button></td>
            </tr>
        </table>

        <div class="columns">
            <div class="column is-narrow">
                <button class="button is-danger" @click="ask_delete()">Удалить выбранные</button>
                <button class="button is-info" @click="export_selected('json')">Экспортировать выбранные</button>
                <button class="button is-info" @click="export_selected('txt')">Экспортировать выбранные (.txt)</button>
            </div>
            <div class="column is-hidden-mobile"></div>
            <div class="column is-narrow">
                <button class="button is-info" @click="open_modal('exportModal')">Импорт</button>
                <button class="button is-primary" @click="add_prop()">Добавить настройку</button>
            </div>
        </div>

        <modal id="editModal" :submit="submit_changes">
            <template slot="header">
                <span v-if="edit_mode">Редактировать настройку</span>
                <span v-else>Добавить настройку</span>
            </template>
            <div class="columns">
                <div class="column field">
                    <label class="label">Код настройки:</label>
                    <input type="text" class="input" v-model="current_row.code"/>
                </div>
                <div class="column field">
                    <label class="label">Тип данных:</label>
                    <div class="select is-fullwidth">
                        <select v-model="current_row.type">
                            <option v-for="option in types" :value="option.code">
                                {{"option.name"|js}}
                            </option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="field">
                <label class="label">Значение:</label>
                <textarea v-model="current_row.value" class="textarea" rows="5"></textarea>
            </div>
            <template slot="actions">
                <button type="submit" class="button is-success" v-if="edit_mode">Сохранить изменения</button>
                <button type="submit" class="button is-success" v-else>Создать</button>
            </template>
        </modal>

        <modal id="exportModal">
            <template slot="header">Экспорт / Импорт</template>

            <div class="field">
                <label class="label">JSON-код или текст:</label>
                <textarea v-model="import_text" class="textarea" rows="8"></textarea>
            </div>

            <template slot="actions">
                <button type="button" @click.stop="do_import" class="button is-success">Импорт</button>
            </template>
        </modal>


        <modal id="deleteModal" size="sm">
            <template slot="header">Подтвердите, пожалуйста</template>

            Удалить выбранные настройки?

            <template slot="actions">
                <button type="button" class="button is-danger" @click="delete_props()">Да</button>
            </template>
        </modal>


    </div>


</props-editor>

<script src="/mjs/comp-props/props.js" defer></script>